function getOrStoreParameter(t){var e=new URLSearchParams(window.location.search).get(t)||"",a=localStorage.getItem(t);return e?(e!==a&&localStorage.setItem(t,e),e):a||""}function updateAnalytics(){setTimeout(()=>{try{var t=document.cookie.split("; ").find(t=>t.startsWith("_ga="))?.split(".").slice(2).join(".")||"";t&&(window.myGlobals.analyticsId=t,$("[name='analytics_id']").val(t))}catch(t){}},2e3)}window.myGlobals={clientId:null,host:null,shopId:null,analyticsId:null,licenseId:null,URL:null,fbclidValue:getOrStoreParameter("fbclid"),gclidValue:getOrStoreParameter("gclid")},window.myGlobals.URL="www.shoper.pl"===window.location.hostname?"https://www.shoper.pl/ajax.php":"https://webflow-sandbox.shoper.pl/ajax.php";let DataLayerGatherers={pushDataLayerEvent(t){window.dataLayer=window.dataLayer||[],window.dataLayer.push(t)},formAbandonEvent(){let e=$(".new__trial-modal"),t=$('[data-element^="modal_trial_"]');var a=$('[data-element="close_trial_wrapper"]');let n=!1,o=null,r=null;function i(){var t;r&&!$(`[data-action="${r}"]`).data("submitted")&&(t=o.val(),DataLayerGatherers.pushDataLayerEvent({event:"formAbandon",formId:r,email:t,action:r,website:"shoper",eventLabel:window.location.href}),n=!1,o=null,r=null)}e.on("input change","input, select, textarea",function(){n=!0}),e.on("focus","input, select, textarea",function(){o=$(this),r=t.filter(function(){return"none"!==$(this).css("display")}).find('[data-action^="create_trial_step"]').attr("data-action")}),e.on("blur","input, select, textarea",function(){n=!0}),a.on("click",function(t){n&&i()}),$(document).on("click",function(t){!$(t.target).closest(e).length&&n&&i()}),$(document).on("keydown",function(t){"Escape"===t.key&&n&&i()}),e.on("submit",'[data-action^="create_trial_step"]',function(){n=!1,o=null,r=null})},controlBlur(){$(document).on("blur","form input",function(){var t=$(this),e=t.closest("form");DataLayerGatherers.pushDataLayerEvent({event:"controlBlur",formId:e.attr("data-action"),controlName:t.attr("data-form"),controlType:t.attr("data-type"),controlValue:t.val()})})},controlFocus(){$(document).on("focus","form input",function(){var t=$(this),e=t.closest("form");DataLayerGatherers.pushDataLayerEvent({event:"controlFocus",formId:e.attr("data-action"),controlName:t.attr("data-form"),controlType:t.attr("data-type"),controlValue:t.val()})})},pushEmailSubmittedData(t,e,a,n){this.pushDataLayerEvent({event:"trial_sign_up",client_id:t,shop_id:e,formId:a,email:n})},pushFormSubmitSuccessData(t,e,a){t={eventName:"formSubmitSuccess",formId:t,eventCategory:"Button form sent",eventLabel:window.location.pathname,eventType:e,eventHistory:window.history};a&&(t.formType=a),this.pushDataLayerEvent(t)},pushTrackEventData(t,e,a){this.pushDataLayerEvent({event:"myTrackEvent",formId:t,eventCategory:"Button form sent",eventAction:e,eventType:a,eventLabel:window.location.pathname})},pushTrackEventDataModal(t,e,a,n,o,r){this.pushDataLayerEvent({event:"formSubmitSuccess",eventCategory:"Button modal form sent",client_id:t,formId:e,shop_id:a,eventAction:n,eventLabel:window.location.pathname,eventType:o,eventHistory:window.history,package:r})},pushTrackEventError(t,e,a){this.pushDataLayerEvent({eventName:"formSubmitError",formId:t,eventCategory:"Button form error",eventAction:e,eventLabel:window.location.pathname,eventType:a,eventHistory:window.history})},pushSubmitError(t,e,a){this.pushDataLayerEvent({eventName:"myTrackEvent",formId:t,eventCategory:"Button form error",eventAction:e,eventLabel:window.location.pathname,eventType:a})},pushTrackEventErrorModal(t,e,a){this.pushDataLayerEvent({eventName:"formSubmitError",formId:t,eventCategory:"Button modal form error",eventAction:e,eventLabel:window.location.pathname,eventType:a,eventHistory:window.history})},pushSubmitErrorModal(t,e,a){this.pushDataLayerEvent({eventName:"myTrackEvent",formId:t,eventCategory:"Button modal form error",eventAction:e,eventLabel:window.location.pathname,eventType:a})},pushModalClosed(){this.pushDataLayerEvent({event:"myTrackEvent",eventCategory:"Button modal closed",eventAction:"",eventType:"modal-form",eventLabel:window.location.pathname})},pushClientTypeChangeEvent(t){this.pushDataLayerEvent({event:"client_type_change",client_type:t})},pushFormInteractionEvent(t,e,a,n){this.pushDataLayerEvent({event:"form_interaction",form_id:t,form_location:e,form_type:a,form_step:n})},checkAndStoreQueryParams(){let t=["utm_source","utm_medium","utm_campaign","utm_content","adgroup","utm_term"],e="adwords";var a=(()=>{let e=new URLSearchParams(window.location.search),a={};return t.forEach(t=>{e.has(t)&&(a[t]=e.get(t))}),a})();0<Object.keys(a).length&&(a={...a=a,timestamp:(new Date).getTime()},localStorage.setItem(e,JSON.stringify(a))),(a=localStorage.getItem(e))&&(a=JSON.parse(a),7776e6<(new Date).getTime()-a.timestamp)&&localStorage.removeItem(e)},getValueTrackData(){var t=localStorage.getItem(VALUE_TRACK_KEY);return t?JSON.parse(t):null},addUtmDataToForm(e){let a=this.getValueTrackData();return a&&Object.keys(a).forEach(t=>{"timestamp"!==t&&(e[`adwords[${t}]`]=a[t])}),e}};function clientTypeChange(){$('input[name="address[client_type]"]').on("change",function(){var t=$(this).closest("label").find("span.w-form-label").text().trim();DataLayerGatherers.pushClientTypeChangeEvent(t)})}function trackFormInteraction(t,e){t.data("interaction-tracked")||(DataLayerGatherers.pushFormInteractionEvent(t.attr("id")||"empty",window.location.pathname,formType,e&&e.length&&e.attr("data-form")||"unknown"),t.data("interaction-tracked",!0))}$(document).ready(function(){DataLayerGatherers.formAbandonEvent(),DataLayerGatherers.controlBlur(),DataLayerGatherers.controlFocus()}),$(document).on("closeModalCalled",DataLayerGatherers.pushModalClosed.bind(DataLayerGatherers)),$(document).ready(function(){$("a[data-app^='open_'], a[data-element^='open_']").click(function(){var t=$(this).data("app")||$(this).data("element"),e=$(this).text(),t=t.split("open_")[1].split("_")[0];DataLayerGatherers.pushDataLayerEvent({event:"myTrackEvent",eventCategory:"Button modal opened",eventAction:e,eventLabel:window.location.href,eventType:t})})}),$(window).on("load",function(){clientTypeChange()}),$(document).ready(function(){$("form").on("focus","input, textarea, select",function(){trackFormInteraction($(this.form),$(this))})});