$(document).ready(function(){$("[data-app='open_trial_modal_button']").on("click",function(){$("[data-app='create_trial_step1_modal']").addClass("modal--open"),$("body").addClass("overflow-hidden")});let s={errors:[],emailRegex:new RegExp('^(([^<>()\\[\\]\\\\.,;:\\s@"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@"]+)*)|(\\".+\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$')};function i(a,e,i){s.errors=[];let r=i.next().next(),o=($(e).trigger("blur"),{2:"Próbujesz uruchomić więcej niż jedną wersję testową sklepu w zbyt krótkim czasie. Odczekaj co najmniej godzinę, zanim zrobisz to ponownie.",3:"Próbujesz uruchomić więcej niż jedną wersję testową sklepu w zbyt krótkim czasie. Odczekaj kilka minut, zanim zrobisz to ponownie.",4:"Uruchomiłeś co najmniej cztery wersje testowe sklepu w zbyt krótkim czasie. Odczekaj 24h od ostatniej udanej próby, zanim zrobisz to ponownie."});if(0===s.errors.length){let a=DataLayerGatherers.getValueTrackData(),t=i.find(".loading-in-button.is-inner");$.ajax({type:"POST",url:window.myGlobals.URL,data:(l={action:$(i).attr("data-action"),email:$(e).val(),"adwords[gclid]":window.myGlobals.gclidValue,"adwords[fbclid]":window.myGlobals.fbclidValue,analyticsId:window.myGlobals.analyticsId,affiliant:$(i).attr("data-affiliant")?$(i).attr("data-affiliant"):""},a&&Object.entries(a).forEach(([a,t])=>{"timestamp"!==a&&(l[`adwords[${a}]`]=t)}),l),beforeSend:function(){t.show()},success:function(a){a.client_id&&(window.myGlobals.clientId=a.client_id),a.host&&(window.myGlobals.host=a.host),a.shop_id&&(window.myGlobals.shopId=a.shop_id),0<a.code&&($(r).text(o[a.code]),$(r).show()),1===a.status?(localStorage.getItem("shoper_affiliate")&&localStorage.removeItem("shoper_affiliate"),$("[data-app='create_trial_step1_modal']").removeClass("modal--open"),$("[data-app='trial-domain']").text(window.myGlobals.host),$('[data-modal="create_trial_step2"]').addClass("modal--open"),a="exit"===$(i).attr("data-item")?"exit_popup":"",DataLayerGatherers.pushEmailSubmittedData(window.myGlobals.clientId,window.myGlobals.shopId,$("#create_trial_step1").attr("data-action"),e.val()),DataLayerGatherers.pushFormSubmitSuccessData($("#create_trial_step1").attr("data-action"),e.val(),a),DataLayerGatherers.pushTrackEventData($("#create_trial_step1").attr("data-action"),$("#create_trial_step1").find("#label").text(),e.val())):(DataLayerGatherers.pushTrackEventError($("#create_trial_step1").attr("data-action"),$("#create_trial_step1").find("#label").text(),e.val()),DataLayerGatherers.pushSubmitError($("#create_trial_step1").attr("data-action"),$("#create_trial_step1").find("#label").text(),e.val()))},error:function(a){console.log("Error: Something went wrong"),$(r).hide()},complete:function(){t.hide()}})}else a.preventDefault();var l}updateAnalytics(),$('[data-action="create_trial_step1"]').each(function(){let t=$(this),e=t.find('[data-type="email"]');e.on("blur",function(){s.errors=function(a,t,e){var i=$(a).val(),r=$(a).next(),o=r.next();$(a).removeClass("error"),r.hide(),o.hide(),i?e.test(i)||($(a).addClass("error"),r.css("display","flex"),t.push("Email is invalid.")):($(a).addClass("error"),o.css("display","flex"),t.push("Email is required."));return t}(this,s.errors,s.emailRegex)}),e.on("keydown",function(a){13===a.which&&(e.trigger("blur"),i(a,e,t))}),e.closest("form").find('[data-form="submit-step-one"]').on("click",function(a){i(a,e,t)})})});